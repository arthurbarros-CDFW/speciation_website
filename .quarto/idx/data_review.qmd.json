{"title":"Simulating Sonar Data","markdown":{"yaml":{"title":"Simulating Sonar Data","bibliography":"references/references.bib","link-citations":true},"headingText":"Identify peaks","containsRefs":false,"markdown":"\n\nBefore we review speciation methods, we can set the baseline of what our\nsonar data set will look like. For a given period of survey, we can\nexpect to have a data set that tells us the date, and the net movement\nof detections. For the examples in this document I'll be simulating both\nsonar and auxiliary data sets for ease of use and replication. I'll give\na general outline in this section on how the data is simulated.\n\nThere a few R packages used in this documentation that can be loaded\nhere:\n\n```{r setup,message=FALSE,warning=FALSE}\n#load packages\nrm( list = ls()) #clear env\nlibrary(tidyverse) #for piping and data formatting ease\nlibrary(ggplot2) #for plotting\nlibrary(lubridate) #makes formatting dates a little easier\nlibrary(caret) #provides the createDataPartition() call for testing/training\nlibrary(nnet) #for multi-nomial regression\nlibrary(mclust) #for gaussian mixed models\n\n```\n\nWe'll start by simulating a simpler sonar detection data set that\ninvolves two species with overlapping distributions of run timing. First\nwe can simulate our fish movement data as having runs with normal\ndistributions centered around two peak dates, which we'll define as\n`peakA` and `peakB`. We'll also make these dates and the date range\nnumeric values so we can build distributions from them.\n\n```{r}\npeakA <- as.numeric(as.Date(\"2023-11-10\")) \npeakB <- as.numeric(as.Date(\"2024-01-12\"))\n```\n\nWe can then create normal distributions of movement data centered around\nour peaks, and combine the data into one data set `combined_counts`,\nwhich we can then turn back into a date format for easy plotting. For\nthis example we'll also assign each record a \"true\" species\nidentification which we can use to test the accuracy of our methods.\n\n```{r}\n# Simulate counts around the peaks using normal distributions \nset.seed(42)  # For reproducibility \nnA=1000\nnB=850\ncountsA <- data.frame(species=\"A\",\n                      date=round(rnorm(n=nA, mean = peakA, sd = 22)))\ncountsB <- data.frame(species=\"B\",\n                      date=round(rnorm(n=nA, mean = peakB, sd = 20)))  \n# Combine the counts \ncombined_counts <- countsA%>%rbind(countsB)\n#combine distributions \ncombined_counts$date<-as.Date(combined_counts$date,origin = \"1970-01-01\") \n```\n\nNext we'll convert the data into the `daily_sonar` data frame and do\nsome additional formatting.\n\n```{r}\n# Create a dataframe with counts \ndaily_sonar <- combined_counts%>%\n  group_by(species,date)%>%\n  tally()\nnames(daily_sonar) <- c(\"species\",\"date\", \"Net_Movement\")  \n```\n\nNow we can bin daily counts by week for easier plotting and\nvisualization.\n\n```{r}\n# Bin the dates by week \ndaily_sonar$Week <- as.Date(cut(daily_sonar$date, breaks = \"week\",  \n                                start.on.monday = TRUE))\n```\n\nOur final `daily_sonar` data frame contains four columns: the \"true\"\n`species` ID we gave the count, the `date` of the observation, the\n`Net_Movement` (essentially count in this case), and the week. Remember\nthat while we gave each simulated observation a \"true\" species code,\neither A or B, we wouldn't actually know that information in our real\nsonar data sets. We will be using the simulated species ID to test our\nspeciation methods accuracy in the following sections.\n\n```{r}\nhead(daily_sonar)\n```\n\nLet's plot the sonar data to see how it's distributed over our simulated\nsurvey period. We see two run peaks centered around the dates we set,\nand what looks like quite a bit of overlap in the the simulated\ndetection timing.\n\n```{r, sonar data simulation plot,height=4, echo=FALSE, fig.cap = \"Plot showing distribution of simulated sonar net movement detections.\"}\n# Plot the results \nggplot(daily_sonar, aes(x = Week, y = Net_Movement)) +   \n  geom_bar(stat = \"identity\", fill = \"steelblue\") +   \n  labs(title = \"Simulated Sonar Detection Data\",        \n       x = \"Week\",        y = \"Net Movement\") +  \n  #scale_x_date(date_labels = \"%Y-%m\", date_breaks = \"1 month\") +   \n  theme_classic()\n```\n\n```{r data_save,echo=FALSE}\n#load packages\nsaveRDS(daily_sonar,\"data/daily_sonar.rds\")\n\n```\n","srcMarkdownNoYaml":"\n\nBefore we review speciation methods, we can set the baseline of what our\nsonar data set will look like. For a given period of survey, we can\nexpect to have a data set that tells us the date, and the net movement\nof detections. For the examples in this document I'll be simulating both\nsonar and auxiliary data sets for ease of use and replication. I'll give\na general outline in this section on how the data is simulated.\n\nThere a few R packages used in this documentation that can be loaded\nhere:\n\n```{r setup,message=FALSE,warning=FALSE}\n#load packages\nrm( list = ls()) #clear env\nlibrary(tidyverse) #for piping and data formatting ease\nlibrary(ggplot2) #for plotting\nlibrary(lubridate) #makes formatting dates a little easier\nlibrary(caret) #provides the createDataPartition() call for testing/training\nlibrary(nnet) #for multi-nomial regression\nlibrary(mclust) #for gaussian mixed models\n\n```\n\nWe'll start by simulating a simpler sonar detection data set that\ninvolves two species with overlapping distributions of run timing. First\nwe can simulate our fish movement data as having runs with normal\ndistributions centered around two peak dates, which we'll define as\n`peakA` and `peakB`. We'll also make these dates and the date range\nnumeric values so we can build distributions from them.\n\n```{r}\n# Identify peaks\npeakA <- as.numeric(as.Date(\"2023-11-10\")) \npeakB <- as.numeric(as.Date(\"2024-01-12\"))\n```\n\nWe can then create normal distributions of movement data centered around\nour peaks, and combine the data into one data set `combined_counts`,\nwhich we can then turn back into a date format for easy plotting. For\nthis example we'll also assign each record a \"true\" species\nidentification which we can use to test the accuracy of our methods.\n\n```{r}\n# Simulate counts around the peaks using normal distributions \nset.seed(42)  # For reproducibility \nnA=1000\nnB=850\ncountsA <- data.frame(species=\"A\",\n                      date=round(rnorm(n=nA, mean = peakA, sd = 22)))\ncountsB <- data.frame(species=\"B\",\n                      date=round(rnorm(n=nA, mean = peakB, sd = 20)))  \n# Combine the counts \ncombined_counts <- countsA%>%rbind(countsB)\n#combine distributions \ncombined_counts$date<-as.Date(combined_counts$date,origin = \"1970-01-01\") \n```\n\nNext we'll convert the data into the `daily_sonar` data frame and do\nsome additional formatting.\n\n```{r}\n# Create a dataframe with counts \ndaily_sonar <- combined_counts%>%\n  group_by(species,date)%>%\n  tally()\nnames(daily_sonar) <- c(\"species\",\"date\", \"Net_Movement\")  \n```\n\nNow we can bin daily counts by week for easier plotting and\nvisualization.\n\n```{r}\n# Bin the dates by week \ndaily_sonar$Week <- as.Date(cut(daily_sonar$date, breaks = \"week\",  \n                                start.on.monday = TRUE))\n```\n\nOur final `daily_sonar` data frame contains four columns: the \"true\"\n`species` ID we gave the count, the `date` of the observation, the\n`Net_Movement` (essentially count in this case), and the week. Remember\nthat while we gave each simulated observation a \"true\" species code,\neither A or B, we wouldn't actually know that information in our real\nsonar data sets. We will be using the simulated species ID to test our\nspeciation methods accuracy in the following sections.\n\n```{r}\nhead(daily_sonar)\n```\n\nLet's plot the sonar data to see how it's distributed over our simulated\nsurvey period. We see two run peaks centered around the dates we set,\nand what looks like quite a bit of overlap in the the simulated\ndetection timing.\n\n```{r, sonar data simulation plot,height=4, echo=FALSE, fig.cap = \"Plot showing distribution of simulated sonar net movement detections.\"}\n# Plot the results \nggplot(daily_sonar, aes(x = Week, y = Net_Movement)) +   \n  geom_bar(stat = \"identity\", fill = \"steelblue\") +   \n  labs(title = \"Simulated Sonar Detection Data\",        \n       x = \"Week\",        y = \"Net Movement\") +  \n  #scale_x_date(date_labels = \"%Y-%m\", date_breaks = \"1 month\") +   \n  theme_classic()\n```\n\n```{r data_save,echo=FALSE}\n#load packages\nsaveRDS(daily_sonar,\"data/daily_sonar.rds\")\n\n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"data_review.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.433","editor":"visual","theme":"cosmo","title":"Simulating Sonar Data","bibliography":["references/references.bib"],"link-citations":true},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}
"0",""
"0","set.seed(Sys.time()) #reset seed"
"0","iterations=100"
"0","results<-data.frame()"
"0","gmm_data<-select(aux_data,length,date,Flow_cfs,species)"
"0","#note here that the Mclust requires date in a numeric format"
"0","gmm_data$num_date<-as.numeric(gmm_data$date) "
"0","for(i in 1:iterations){"
"0","  train_index <- createDataPartition(gmm_data$species, p = 0.7, list = FALSE) "
"0","  train_data <- gmm_data[train_index, ]"
"0","  test_data <- gmm_data[-train_index, ]"
"0","  "
"0","  Ntrue_A<-sum(test_data$species==""A"")"
"0","  Ntrue_B<-sum(test_data$species==""B"")"
"0","  Ntrue_C<-sum(test_data$species==""C"")"
"0","  "
"0","  #Fit a Gaussian Mixture Model to the training data "
"0","  model_iter <- Mclust(train_data[, c(""length"", ""num_date"")], G=3)"
"0","  "
"0","  #summary(model_iter)"
"0","  # Predict species for the test data based on the trained model"
"0","  predictions <- predict(model_iter, test_data[, c(""length"", ""num_date"")])"
"0","  test_data$species_predicted <- factor(predictions$classification,"
"0","                                        levels = 1:3, labels = c(""A"",""B"",""C""))"
"0","  "
"0","  accuracy <- sum(test_data$species_predicted == "
"0","                    test_data$species)/nrow(test_data)"
"0","  "
"0","  #Change in abundance estimate:"
"0","  #here I can sum the probability for each classification to "
"0","  #estimate total abundance"
"0","  #instead of using the threshold classification method"
"0","  Nest_A<-sum(predictions$z[,1])"
"0","  Nest_B<-sum(predictions$z[,2])"
"0","  Nest_C<-sum(predictions$z[,3])"
"0",""
"0","  error_A <- abs(Nest_A - Ntrue_A)"
"0","  error_B <- abs(Nest_B - Ntrue_B)"
"0","  error_C <- abs(Nest_C - Ntrue_C)"
"0",""
"0","  rel_error_A <- error_A / Ntrue_A"
"0","  rel_error_B <- error_B / Ntrue_B"
"0","  rel_error_C <- error_C / Ntrue_C"
"0","  "
"0","  MAPE <- mean(c(rel_error_A, rel_error_B, rel_error_C)) * 100"
"0","  d<-data.frame(""accuracy""=accuracy,""MAPE""=MAPE)"
"0","  "
"0","  results<-results%>%rbind(d)"
"0","}"
"1","fitting ...
"
"1","  |                                                                          "
"1","  |                                                                    |   0%"
"1","  |                                                                          "
"1","  |=====                                                               |   7%"
"1","  |                                                                          "
"1","  |=========                                                           |  13%"
"1","  |                                                                          "
"1","  |==============                                                      |  20%"
"1","  |                                                                          "
"1","  |==================                                                  |  27%"
"1","  |                                                                          "
"1","  |=======================                                             |  33%"
"1","  |                                                                          "
"1","  |===========================                                         |  40%"
"1","  |                                                                          "
"1","  |================================                                    |  47%"
"1","  |                                                                          "
"1","  |====================================                                |  53%"
"1","  |                                                                          "
"1","  |=========================================                           |  60%"
"1","  |                                                                          "
"1","  |=============================================                       |  67%"
"1","  |                                                                          "
"1","  |==================================================                  |  73%"
"1","  |                                                                          "
"1","  |======================================================              |  80%"
"1","  |                                                                          "
"1","  |===========================================================         |  87%"
"1","  |                                                                          "
"1","  |===============================================================     |  93%"
"1","  |                                                                          "
"1","  |====================================================================| 100%"
"1","
"
"1","fitting ...
"
"1","  |                                                                          "
"1","  |                                                                    |   0%"
"1","  |                                                                          "
"1","  |=====                                                               |   7%"
"1","  |                                                                          "
"1","  |=========                                                           |  13%"
"1","  |                                                                          "
"1","  |==============                                                      |  20%"
"1","  |                                                                          "
"1","  |==================                                                  |  27%"
"1","  |                                                                          "
"1","  |=======================                                             |  33%"
"1","  |                                                                          "
"1","  |===========================                                         |  40%"
"1","  |                                                                          "
"1","  |================================                                    |  47%"
"1","  |                                                                          "
"1","  |====================================                                |  53%"
"1","  |                                                                          "
"1","  |=========================================                           |  60%"
"1","  |                                                                          "
"1","  |=============================================                       |  67%"
"1","  |                                                                          "
"1","  |==================================================                  |  73%"
"1","  |                                                                          "
"1","  |======================================================              |  80%"
"1","  |                                                                          "
"1","  |===========================================================         |  87%"
"1","  |                                                                          "
"1","  |===============================================================     |  93%"
"1","  |                                                                          "
"1","  |====================================================================| 100%"
"1","
"
"1","fitting ...
"
"1","  |                                                                          "
"1","  |                                                                    |   0%"
"1","  |                                                                          "
"1","  |=====                                                               |   7%"
"1","  |                                                                          "
"1","  |=========                                                           |  13%"
"1","  |                                                                          "
"1","  |==============                                                      |  20%"
"1","  |                                                                          "
"1","  |==================                                                  |  27%"
"1","  |                                                                          "
"1","  |=======================                                             |  33%"
"1","  |                                                                          "
"1","  |===========================                                         |  40%"
"1","  |                                                                          "
"1","  |================================                                    |  47%"
"1","  |                                                                          "
"1","  |====================================                                |  53%"
"1","  |                                                                          "
"1","  |=========================================                           |  60%"
"1","  |                                                                          "
"1","  |=============================================                       |  67%"
"1","  |                                                                          "
"1","  |==================================================                  |  73%"
"1","  |                                                                          "
"1","  |======================================================              |  80%"
"1","  |                                                                          "
"1","  |===========================================================         |  87%"
"1","  |                                                                          "
"1","  |===============================================================     |  93%"
"1","  |                                                                          "
"1","  |====================================================================| 100%"
"1","
"
"1","fitting ...
"
"1","  |                                                                          "
"1","  |                                                                    |   0%"
"1","  |                                                                          "
"1","  |=====                                                               |   7%"
"1","  |                                                                          "
"1","  |=========                                                           |  13%"
"1","  |                                                                          "
"1","  |==============                                                      |  20%"
"1","  |                                                                          "
"1","  |==================                                                  |  27%"
"1","  |                                                                          "
"1","  |=======================                                             |  33%"
"1","  |                                                                          "
"1","  |===========================                                         |  40%"
"1","  |                                                                          "
"1","  |================================                                    |  47%"
"1","  |                                                                          "
"1","  |====================================                                |  53%"
"1","  |                                                                          "
"1","  |=========================================                           |  60%"
"1","  |                                                                          "
"1","  |=============================================                       |  67%"
"1","  |                                                                          "
"1","  |==================================================                  |  73%"
"1","  |                                                                          "
"1","  |======================================================              |  80%"
"1","  |                                                                          "
"1","  |===========================================================         |  87%"
"1","  |                                                                          "
"1","  |===============================================================     |  93%"
"1","  |                                                                          "
"1","  |====================================================================| 100%"
"1","
"
"1","fitting ...
"
"1","  |                                                                          "
"1","  |                                                                    |   0%"
"1","  |                                                                          "
"1","  |=====                                                               |   7%"
"1","  |                                                                          "
"1","  |=========                                                           |  13%"
"1","  |                                                                          "
"1","  |==============                                                      |  20%"
"1","  |                                                                          "
"1","  |==================                                                  |  27%"
"1","  |                                                                          "
"1","  |=======================                                             |  33%"
"1","  |                                                                          "
"1","  |===========================                                         |  40%"
"1","  |                                                                          "
"1","  |================================                                    |  47%"
"1","  |                                                                          "
"1","  |====================================                                |  53%"
"1","  |                                                                          "
"1","  |=========================================                           |  60%"
"1","  |                                                                          "
"1","  |=============================================                       |  67%"
"1","  |                                                                          "
"1","  |==================================================                  |  73%"
"1","  |                                                                          "
"1","  |======================================================              |  80%"
"1","  |                                                                          "
"1","  |===========================================================         |  87%"
"1","  |                                                                          "
"1","  |===============================================================     |  93%"
"1","  |                                                                          "
"1","  |====================================================================| 100%"
"1","
"
"1","fitting ...
"
"1","  |                                                                          "
"1","  |                                                                    |   0%"
"1","  |                                                                          "
"1","  |=====                                                               |   7%"
"1","  |                                                                          "
"1","  |=========                                                           |  13%"
"1","  |                                                                          "
"1","  |==============                                                      |  20%"
"1","  |                                                                          "
"1","  |==================                                                  |  27%"
"1","  |                                                                          "
"1","  |=======================                                             |  33%"
"1","  |                                                                          "
"1","  |===========================                                         |  40%"
"1","  |                                                                          "
"1","  |================================                                    |  47%"
"1","  |                                                                          "
"1","  |====================================                                |  53%"
"1","  |                                                                          "
"1","  |=========================================                           |  60%"
"1","  |                                                                          "
"1","  |=============================================                       |  67%"
"1","  |                                                                          "
"1","  |==================================================                  |  73%"
"1","  |                                                                          "
"1","  |======================================================              |  80%"
"1","  |                                                                          "
"1","  |===========================================================         |  87%"
"1","  |                                                                          "
"1","  |===============================================================     |  93%"
"1","  |                                                                          "
"1","  |====================================================================| 100%"
"1","
"
"1","fitting ...
"
"1","  |                                                                          "
"1","  |                                                                    |   0%"
"1","  |                                                                          "
"1","  |=====                                                               |   7%"
"1","  |                                                                          "
